%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Journal Article
% LaTeX Template
% Version 2.0 (February 7, 2023)
%
% This template originates from:
% https://www.LaTeXTemplates.com
%
% Author:
% Vel (vel@latextemplates.com)
%
% License:
% CC BY-NC-SA 4.0 (https://creativecommons.org/licenses/by-nc-sa/4.0/)
%
% NOTE: The bibliography needs to be compiled using the biber engine.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Modified by:
% Pakorn Wangsuekul (joe@ai.iit.tsukuba.ac.jp)
%
% Version 2.1 (July 9, 2023)
% Version 2.2 by Hiroaki Yano (July 11, 2023) 
% Version 2.3 (July 13, 2023)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[
	a4paper, % Paper size, use either a4paper or letterpaper
	10pt, % Default font size, can also use 11pt or 12pt, although this is not recommended
	% unnumberedsections, % Uncomment to remove section numbering
	% twoside, % Uncomment to enable two side traditional mode where headers and footers change between odd and even pages
]{LTJournalArticle}
\usepackage[italian]{babel}
\addbibresource{bibliography.bib} % BibLaTeX bibliography file

\headerleft{Laboratorio di Misure Industriali} % Left running head
\headerright{Gruppo M: Pietro Agnelli, Matteo Berardi, Riccardo Valtorta} % Right running head: Student ID and Name

\footertext{} % Text to appear in the footer, leave this command empty for no footer text

\setcounter{page}{1} % Page number of the first page, set this to a higher number if the article is to be part of a larger publication

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

% Report title
\title{Implementazione di sistemi di correzione della stima della posa di un AGV agricolo all'interno di un filare.} % Article title, max 3 lines recommended

% Author's name
\author{
	Gruppo M: Pietro Agnelli, Matteo Berardi, Riccardo Valtorta \hfill \fontsize{9pt}{12pt}\selectfont\\
}

% Supervisor name and Laboratory name
\date{
         Laboratorio di Misure Industriali %\hfill Insert Laboratory Name Here
}
%----------------------------------------------------------------------------------------
\begin{document}

\maketitle % Output the title section

%----------------------------------------------------------------------------------------
%	ARTICLE CONTENTS
%----------------------------------------------------------------------------------------

\section{Calibrazione della camera}

Il primo passo, indispensabile prima di eseguire misurazioni attraverso sistemi di visione, è ricavare i parametri intrinseci della videocamera Intel Realsense T265 utilizzata. La procedura di calibrazione consiste nell'acquisizione di $30$ immagini di un pattern noto (una scacchiera appositamente realizzata e fissata su un supporto rigido), in diverse posizioni e prospettive, che vengono poi processate dal software della telecamera per effettuare la stima dei parametri intrinseci. 

\section{Setup sperimentale}
\subsection{Setup lineare}
Il primo setup è stato realizzato montando una guida rettilinea su un banco ottico. La guida presenta un profilo munito di sedi per dadi "a T", all'interno delle quali viene fatto scorrere il carrello. La telecamera può essere montata sul carrello orientata in vario modo rispetto all'asse del movimento. La guida ha una lunghezza utile di $2\ m$.
\subsection{Setup angolare}
Il secondo setup, pensato per poter permettere unicamente la rotazione sul piano orizzontale, è stato realizzato incernierando l'estremità di un'asta al banco ottico. La telecamera è stata montata in corrispondenza della cerniera, in modo da minimizzare la componente traslatoria del movimento, e quindi le interferenze nelle rilevazioni sperimentali.

\section{Stima dell'incertezza}

\subsection{Marker ArUco}

Per stimare l'incertezza in ciascuna delle due direzioni e ad angoli differenti abbiamo posizionato un marker ArUco $100mm\times100mm$, variandone l'orientamento, davanti alla camera, quindi abbiamo mosso la camera nella direzione perpendicolare a quella lungo la quale eravamo interessati a stimare l'incertezza. Abbiamo poi eseguito una regressione lineare ai minimi quadrati sulle posizioni misurate e stimato l'incertezza attraverso la \ref{eq:lls}.
\vspace{-4pt}
\begin{equation}
    \sigma = \sqrt{\frac{\sum_{j=1}^{m}(y(x_{j})-y_{j})}{m-n}}
    \label{eq:lls}
\end{equation}
\vspace{-8pt}
I risultati ottenuti sono riportati in tabella \ref{tab:uaruco}.
\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|c|}
    \hline
        $\sigma_x$ [$mm$]& $\sigma_z$ [$mm$]  & $\sigma_{\theta} [$°$]$ \\
        \hline
        $13$& $19$ & $5.7$ \\
    \hline
    \end{tabular}
    \caption{Incertezze sulle misure dei marker ArUco.}
    \label{tab:uaruco}
\end{table}
\vspace{-18pt}
\subsection{Odometria visivo-inerziale}

La stima dell'incertezza legata all'odometria risulta più complessa, in quanto si tratta di un metodo di misura \emph{incrementale}. Inoltre, gli algoritmi utilizzati dal software della telecamera non sono noti, ciò rende lo strumento, una \emph{black-box}.
\vspace{-18pt}
\paragraph{Incertezza in condizioni statiche} La prima prova eseguita è stata semplicemente verificare la corretta stima della posizione a telecamera ferma. L'acquisizione è stata avviata per $5$ secondi a $12 fps$, per un totale di $10$ prove. L'incertezza è stata calcolata come in \ref{eq:lls}, ponendo $y_{j}=0$ per $j=1,2,...,m$ e
$n=1$.
\vspace{-12pt}
\paragraph{Incertezza incrementale} La stima dell'incertezza incrementale si è svolta in due fasi. A partire dal modello \ref{eq:model}, e assumendo assenza di correlazione tra le incertezze, abbiamo ottenuto la propagazione dell'incertezza \ref{eq:prop}. Ragionamenti analoghi valgono per la coordinata $z$.
\vspace{-4pt}
\begin{equation}
        x_n =x_{n-1}+\Delta x  \sin{(\theta_{n-1})}
    \label{eq:model}
\end{equation}
\vspace{-10pt}
\vspace{-4pt}
\begin{equation}
        \sigma_{x_n}^2 = \sigma_{x_{n-1}}^2 + \sigma_{\Delta x}^2 \cos{(\theta_{n-1})}^2 + \sigma_{\theta_{n-1}}^2 \Delta x ^2 \sin{(\theta_{n-1})}^2
        \label{eq:prop}
\end{equation}

Dove
\begin{equation}
    \sigma_{\theta_{n}}^2 = \sigma_{\theta_{n-1}}^2 + \sigma_{\omega}^2 \delta t^2
    \label{eq:angleprop}
\end{equation}

Abbiamo verificato sperimentalmente la correttezza del modello che però non si è rivelato coerente con i risultati ottenuti attraverso i test a distanze note e angoli noti, pertanto, non disponendo di informazioni sugli algoritmi interni alla videocamera, abbiamo preferito affidare la stima dell'incertezza incrementale ad una regressione effettuata sui dati ricavati da queste ultime prove.

\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|}
    \hline
       $x$ [$mm$]          & $0$ & $1500$ & $1000$ & $1500$ & $2000$\\
    \hline
        $\sigma_x$ [$mm$]&  $7.7$ & $3.2$ & $30$ & $55$ & $80$\\
        $\sigma_z$ [$mm$]&  $6.6$ & $3.7$ & $6.9$ & $13$ & $18$\\
        $\sigma_{\theta} [$°$]$ & $0.033$ & $0.26$ & $0.38$ & $0.59$ & $0.29$\\
    \hline
    \end{tabular}
    \caption{Incertezze sulle misure odometriche al variare della distanza percorsa.}
    \label{tab:uncertainties}
\end{table}
\vspace{-15pt}
Il modello è ottenuto minimizzando la somma dei quadrati dei residui (metodo dei minimi quadrati) attraverso la fattorizzazione QR ed è costituito da una funzione della forma \ref{eq:model}, dove $y = {x,z,\theta}$.
\vspace{-10pt}
\begin{equation}
    y = \beta_0 + \beta_{1}p_{x} + \beta_{2}p_{z} + \beta_{3}v_{x} + \beta_{4}v_{z} + \beta_{5}\theta
    \label{eq:model}
\end{equation}

\section{Algoritmi implementati}

Il primo algoritmo consiste nell'implementazione del teorema del limite centrale per unire le informazioni ricavate dai marker e quelle fornite dall'odometria, il teorema del limite centrale, applicato ad un caso sperimentale, ottiene un'incertezza $max(\sigma_{clt}) = 0.14\ m$.

Il secondo algoritmo sfrutta il teorema di Bayes.

Infine il terzo algoritmo realizza un filtro di Kalman utilizzando il modello in \ref{eq:kalman}.
\begin{equation}
\underbrace{
    \begin{bmatrix}
            x_{n}\\z_{n}\\\theta_{n}
    \end{bmatrix}
}_{\hat{x_n}}
=\underbrace{
    \begin{bmatrix}
           1 & 0 & \cos(\theta_{n-1})\\
           0 & 1 & \cos(\theta_{n-1})\\
           0 & 0 & 1
    \end{bmatrix}
}_{F}
\underbrace{
    \begin{bmatrix}
            x_{n-1}\\z_{n-1}\\\theta_{n-1}
    \end{bmatrix}
}_{x_{n-1}}
+
\underbrace{
    \begin{bmatrix}
           1 & 0 \\
           0 & 1 \\
           0 & 0
    \end{bmatrix}
}_{G}
\underbrace{
    \begin{bmatrix}
           v_{x}\\
           v_{z}
    \end{bmatrix}
}_{u}
\label{eq:kalman}
\end{equation}
%----------------------------------------------------------------------------------------
%	 REFERENCES
%----------------------------------------------------------------------------------------

\printbibliography % Output the bibliography

%----------------------------------------------------------------------------------------

\end{document}
